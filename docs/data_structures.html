

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Data Structures &mdash; StarKiller Microphysics 18.10 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Runtime parameters" href="rp_intro.html" />
    <link rel="prev" title="StarKiller Basics" href="basics.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> StarKiller Microphysics
          

          
          </a>

          
            
            
              <div class="version">
                18.10
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">StarKiller basics</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="preface.html">preface</a></li>
<li class="toctree-l1"><a class="reference internal" href="basics.html">StarKiller Basics</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Data Structures</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#eos">EOS</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#eos-t"><code class="docutils literal notranslate"><span class="pre">eos_t</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#networks">Networks</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#burn-t"><code class="docutils literal notranslate"><span class="pre">burn_t</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#rate-t"><code class="docutils literal notranslate"><span class="pre">rate_t</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#burn-type-module"><code class="docutils literal notranslate"><span class="pre">burn_type_module</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#integrators">Integrators</a></li>
<li class="toctree-l2"><a class="reference internal" href="#converting-between-types">Converting Between Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="#initial-values-and-threadsafety">Initial Values and Threadsafety</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="rp_intro.html">Runtime parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="eos.html">Equations of State</a></li>
<li class="toctree-l1"><a class="reference internal" href="networks.html">Reaction Networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="transport.html">Transport Coefficients</a></li>
<li class="toctree-l1"><a class="reference internal" href="openacc.html">GPUs</a></li>
<li class="toctree-l1"><a class="reference internal" href="unit_tests.html">Unit Tests</a></li>
<li class="toctree-l1"><a class="reference internal" href="sdc.html">Spectral Deferred Corrections</a></li>
<li class="toctree-l1"><a class="reference internal" href="references.html">References</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">StarKiller Microphysics</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Data Structures</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/data_structures.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

/* nice headers on first paragraph of info/warning boxes */
.admonition .first {
    margin: -12px;
    padding: 6px 12px;
    margin-bottom: 12px;
    color: #fff;
    line-height: 1;
    display: block;
}
.admonition.warning .first {
    background: #f0b37e;
}
.admonition.note .first {
    background: #6ab0de;
}
.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}
</style>
<div class="section" id="data-structures">
<h1>Data Structures<a class="headerlink" href="#data-structures" title="Permalink to this headline">¶</a></h1>
<p>All of the routines in this software package are standardized so that
you interact with them using the same type of data structure, a
Fortran derived type (which, for our purposes, is analogous to a
C++ struct).</p>
<div class="section" id="eos">
<h2>EOS<a class="headerlink" href="#eos" title="Permalink to this headline">¶</a></h2>
<div class="section" id="eos-t">
<h3><code class="docutils literal notranslate"><span class="pre">eos_t</span></code><a class="headerlink" href="#eos-t" title="Permalink to this headline">¶</a></h3>
<p>The main data structure for interacting with the EOS is <code class="docutils literal notranslate"><span class="pre">eos_t</span></code>.
This is a collection of data specifying the microphysical state of the
fluid that we are evaluating. This derived type has many components,
and in the Fortran syntax we access them with the <code class="docutils literal notranslate"><span class="pre">%</span></code> operator. For a
particular instantiation named eos_state, the most important
data is the following:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">eos_state</span> <span class="pre">%</span> <span class="pre">rho</span></code> : density [<span class="math notranslate nohighlight">\(\mathrm{g~cm^{-3}}\)</span>]</li>
<li><code class="docutils literal notranslate"><span class="pre">eos_state</span> <span class="pre">%</span> <span class="pre">T</span></code> : temperature [K]</li>
<li><code class="docutils literal notranslate"><span class="pre">eos_state</span> <span class="pre">%</span> <span class="pre">p</span></code> : pressure [<span class="math notranslate nohighlight">\(\mathrm{erg~cm^{-3}}\)</span>]</li>
<li><code class="docutils literal notranslate"><span class="pre">eos_state</span> <span class="pre">%</span> <span class="pre">e</span></code> : specific internal energy [<span class="math notranslate nohighlight">\(\mathrm{erg~g^{-1}}\)</span>]</li>
<li><code class="docutils literal notranslate"><span class="pre">eos_state</span> <span class="pre">%</span> <span class="pre">h</span></code> : specific enthalpy [<span class="math notranslate nohighlight">\(\mathrm{erg~g^{-1}}\)</span>]</li>
<li><code class="docutils literal notranslate"><span class="pre">eos_state</span> <span class="pre">%</span> <span class="pre">s</span></code> : specific entropy [<span class="math notranslate nohighlight">\(\mathrm{erg~g^{-1}~K^{-1}}\)</span>]</li>
<li><code class="docutils literal notranslate"><span class="pre">eos_state</span> <span class="pre">%</span> <span class="pre">xn</span></code> : mass fractions of species (this is an array, dimensioned to be the number of species, <code class="docutils literal notranslate"><span class="pre">nspec</span></code> )</li>
<li><code class="docutils literal notranslate"><span class="pre">eos_state</span> <span class="pre">%</span> <span class="pre">aux</span></code> : any auxiliary variables carried with the fluid (this is an array, dimensioned to be the number of auxiliary quantities, <code class="docutils literal notranslate"><span class="pre">naux</span></code> )</li>
</ul>
<p>Note that both <code class="docutils literal notranslate"><span class="pre">nspec</span></code> and <code class="docutils literal notranslate"><span class="pre">naux</span></code> are meant to be properties of the
network, and they will come in through the <code class="docutils literal notranslate"><span class="pre">network</span></code> module.</p>
<p>There is a lot more information that can be saved here, such as the
partial derivatives of the thermodynamic state variables with respect
to each other. To see a complete list, examine the <code class="docutils literal notranslate"><span class="pre">eos_type.f90</span></code>
file inside the code calling Microphysics (e.g.
<code class="docutils literal notranslate"><span class="pre">Castro/Microphysics/EOS/eos_type.f90</span></code>).</p>
</div>
</div>
<div class="section" id="networks">
<h2>Networks<a class="headerlink" href="#networks" title="Permalink to this headline">¶</a></h2>
<div class="section" id="burn-t">
<h3><code class="docutils literal notranslate"><span class="pre">burn_t</span></code><a class="headerlink" href="#burn-t" title="Permalink to this headline">¶</a></h3>
<p>The main data structure for interacting with the reaction networks is
<code class="docutils literal notranslate"><span class="pre">burn_t</span></code>. This holds the composition (mass fractions), thermodynamic
state, and a lot of internal information used by the reaction network
(e.g. the righthand side of the ODEs, the Jacobian, etc.). Typically
the user will only need to fill/use the following information:</p>
<ul>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">burn_state</span> <span class="pre">%</span> <span class="pre">rho</span></code>: density [<span class="math notranslate nohighlight">\(\mathrm{g~cm^{-3}}\)</span>]</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">burn_state</span> <span class="pre">%</span> <span class="pre">T</span></code>: temperature [K]</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">burn_state</span> <span class="pre">%</span> <span class="pre">e</span></code>: the specific internal energy [<span class="math notranslate nohighlight">\(\mathrm{erg~g^{-1}}\)</span>]</p>
<blockquote>
<div><p>Note: this has two different contexts, depending on when it is
accessed.</p>
<p>When you call the integrator and are in the process of integrating
the reaction system, e will be an integration variable and
will account for the nuclear energy release. Due to the nature
of our ODE system, this will not be thermodynamically consistent with
<span class="math notranslate nohighlight">\(\rho, T\)</span></p>
<p>Upon exit of the integration, the initial internal energy (offset)
is subtracted off, and e now represents the specifc nuclear
energy release from the reactions.</p>
</div></blockquote>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">burn_state</span> <span class="pre">%</span> <span class="pre">xn(:)</span></code>: the mass fractions</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">burn_state</span> <span class="pre">%</span> <span class="pre">aux(:)</span></code>: any auxiliary quantities (like <span class="math notranslate nohighlight">\(Y_e\)</span>)</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">burn_state</span> <span class="pre">%</span> <span class="pre">i</span></code>, <code class="docutils literal notranslate"><span class="pre">%</span> <span class="pre">j</span></code>, <code class="docutils literal notranslate"><span class="pre">%</span> <span class="pre">k</span></code>: hydrodynamic zone i, j, k for bug reporting, diagnostics</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">burn_state</span> <span class="pre">%</span> <span class="pre">time</span></code>: the time since the start of the integration [s]</p>
<blockquote>
<div><p>Note this is not the same as the simulation time. Each integrator
will also store the simulation time at the start of integration
in their local storage—this can be used as an offset to convert
between integration and simulation time.</p>
</div></blockquote>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">burn_state</span> <span class="pre">%</span> <span class="pre">shock</span></code>: are we inside of a hydrodynamic shock (the burner may wish to take action in this case)</p>
</li>
</ul>
</div>
<div class="section" id="rate-t">
<h3><code class="docutils literal notranslate"><span class="pre">rate_t</span></code><a class="headerlink" href="#rate-t" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">rate_t</span></code> structure is used internally in a network to pass the
raw reaction rate information (usually just the temperature-dependent
terms) between various subroutines. It does not come out of the
network-specific righthand side or Jacobian routines.</p>
<p>This main component of this is simply an array of dimension
<code class="docutils literal notranslate"><span class="pre">rates(num_rate_groups,</span> <span class="pre">nrates)</span></code>—both of the parameters
used in dimensioning this are network-dependent.</p>
</div>
<div class="section" id="burn-type-module">
<h3><code class="docutils literal notranslate"><span class="pre">burn_type_module</span></code><a class="headerlink" href="#burn-type-module" title="Permalink to this headline">¶</a></h3>
<p>In addition to defining the <code class="docutils literal notranslate"><span class="pre">burn_t</span></code> type, the <code class="docutils literal notranslate"><span class="pre">burn_type_module</span></code>
also defines integer indices into the solution vector that can be used
to access the different components of the state:</p>
<ul>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">neqs</span></code> : the total number of variables we are integrating.</p>
<blockquote>
<div><p>It is assumed that the first <code class="docutils literal notranslate"><span class="pre">nspec_evolve</span></code> are the species.</p>
</div></blockquote>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">net_itemp</span></code> : the index of the temperature in the solution vector</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">net_ienuc</span></code> : the index of the specifc internal energy in the solution vector</p>
</li>
</ul>
</div>
</div>
<div class="section" id="integrators">
<h2>Integrators<a class="headerlink" href="#integrators" title="Permalink to this headline">¶</a></h2>
<p>Each integrator also has their own internal data structure that holds
the information needed for the integration. Meta-data that is not part
of the integration vector of ODEs, but is attached to a particular
state (<span class="math notranslate nohighlight">\(X_k\)</span>, <span class="math notranslate nohighlight">\(T\)</span>, <span class="math notranslate nohighlight">\(e\)</span>), is stored in an array that
can be passed into the righthand side routine. The different fields
are accessed through the integer indices in the <code class="docutils literal notranslate"><span class="pre">rpar_indices</span></code> Fortran
module. The details of this storage is given for each integrator
below.</p>
</div>
<div class="section" id="converting-between-types">
<h2>Converting Between Types<a class="headerlink" href="#converting-between-types" title="Permalink to this headline">¶</a></h2>
<p>There is significant overlap between <code class="docutils literal notranslate"><span class="pre">eos_t</span></code> and <code class="docutils literal notranslate"><span class="pre">burn_t</span></code>.
The <code class="docutils literal notranslate"><span class="pre">burn_type_module</span></code> provides two routines,
<code class="docutils literal notranslate"><span class="pre">burn_to_eos</span></code> and <code class="docutils literal notranslate"><span class="pre">eos_to_burn</span></code> that convert a <code class="docutils literal notranslate"><span class="pre">burn_t</span></code>
state to an <code class="docutils literal notranslate"><span class="pre">eos_t</span></code> state, and back. Only the thermodynamic
variables that are common in the two types are copied. This is
useful, for example, if you have a burn_t state and what to get
thermodynamic information by calling the EOS.</p>
</div>
<div class="section" id="initial-values-and-threadsafety">
<h2>Initial Values and Threadsafety<a class="headerlink" href="#initial-values-and-threadsafety" title="Permalink to this headline">¶</a></h2>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="rp_intro.html" class="btn btn-neutral float-right" title="Runtime parameters" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="basics.html" class="btn btn-neutral" title="StarKiller Basics" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, StarKiller Development Team

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"TeX": {"Macros": {"rhozero": "{\\rho_0}", "pizero": "{\\pi_0}", "pizeroone": "{\\pi_0^{(1)}}", "pizerotwo": "{\\pi_0^{(2)}}", "gammabar": "{\\overline{\\Gamma}_1}", "ptl": "{{\\partial}}", "eb": "{{\\bf e}}", "fb": "{{\\bf f}}", "ib": "{{\\bf i}}", "Ub": "{{\\bf U}}", "Vb": "{{\\bf V}}", "xb": "{{\\bf x}}", "ut": "{\\tilde{u}}", "vt": "{\\tilde{v}}", "wt": "{\\tilde{w}}", "Ubt": "{\\widetilde{\\Ub}}", "edge": "{\\rm EDGE}", "mac": "{\\rm MAC}", "trans": "{\\rm TRANS}", "nablab": "{\\mathbf{\\nabla}}", "cdotb": "{\\mathbf{\\cdot}}", "half": "{\\frac{1}{2}}", "myhalf": "{\\frac{1}{2}}", "nph": "{{n + \\myhalf}}", "nmh": "{{n - \\myhalf}}", "Hext": "{{H_{\\rm ext}}}", "Hnuc": "{{H_{\\rm nuc}}}", "kth": "{k_{\\rm th}}", "pred": "{{\\rm pred}}", "Sbar": "{\\overline{S}}", "inp": "{\\mathrm{in}}", "initp": "{\\mathrm{init}}", "outp": "{\\mathrm{out}}", "uadv": "{\\widetilde{\\mathbf{U}}^{\\mathrm{ADV}}}", "uadvone": "{\\widetilde{\\mathbf{U}}^{\\mathrm{ADV},\\star}}", "uadvonedag": "{\\Ubt^{\\mathrm{ADV},\\dagger,\\star}}", "uadvtwo": "{\\widetilde{\\mathbf{U}}^{\\mathrm{ADV}}}", "uadvtwodag": "{\\Ubt^{\\mathrm{ADV},\\dagger}}", "uadvsdcstar": "{\\mathbf{U}^{\\mathrm{ADV},\\star}}", "uadvsdcpred": "{\\mathbf{U}^{\\mathrm{ADV},\\mathrm{pred}}}", "uadvsdc": "{\\mathbf{U}^{\\mathrm{ADV}}}", "dt": "{\\Delta t}", "dr": "{\\Delta r}", "etarho": "{\\eta_{\\rho}}", "etarhoec": "{\\etarho^{\\rm ec}}", "etarhocc": "{\\etarho^{\\rm cc}}", "etarhoflux": "{\\etarho^{\\rm flux}}", "divetarho": "{\\nabla\\cdot(\\etarho\\eb_r)}", "ow": "{\\overline{w}_0}", "dw": "{\\delta w_0}", "thalf": "{\\sfrac{3}{2}}", "rhop": "{{\\rho^{\\prime}}}", "omegadot": "{\\dot{\\omega}}", "er": "{\\mathbf{e}_r}", "ex": "{\\mathbf{e}_x}", "ey": "{\\mathbf{e}_y}", "ez": "{\\mathbf{e}_z}", "Omegab": "{{\\bf \\Omega}}", "rb": "{{\\bf r}}", "isotm": ["{{}^{#2}\\mathrm{#1}}", 2], "edot": "{{{\\dot{e}_\\mathrm{nuc}}}}", "enuc": "{{{{e}_\\mathrm{nuc}}}}", "edotnu": "{{{\\dot{e}_\\nu}}}", "rt": "{\\tilde{r}_0}", "rhob": "{\\ensuremath{\\rho_\\mathrm{base}}}", "Tb": "{\\ensuremath{T_\\mathrm{base}}}", "gcc": "{\\mathrm{g~cm^{-3} }}", "pb": "{p_\\mathrm{base}}", "qburn": "{q_\\mathrm{burn}}", "Uc": "{{\\boldsymbol{\\mathcal{U}}}}", "Fb": "{\\mathbf{F}}", "Sc": "{\\mathbf{S}}", "Shydro": "{{{\\bf S}^{\\mathrm{hydro}}}}", "Rb": "{{\\bf R}}", "Rq": "{{\\bf R}}", "Adv": ["{{\\left [\\mathcal{A} \\left(#1\\right)\\right]}}", 1], "Advs": ["{{\\mathcal{A} \\left(#1\\right)}}", 1], "Sdot": "{\\dot{S}}"}}})</script>
    

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>