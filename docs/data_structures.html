<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Data Structures &mdash; Microphysics  documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/theme_overrides.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=5929fcd5"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "macros": {"rhozero": "{\\rho_0}", "pizero": "{\\pi_0}", "pizeroone": "{\\pi_0^{(1)}}", "pizerotwo": "{\\pi_0^{(2)}}", "gammabar": "{\\overline{\\Gamma}_1}", "ptl": "{{\\partial}}", "eb": "{{\\bf e}}", "fb": "{{\\bf f}}", "ib": "{{\\bf i}}", "Ub": "{{\\bf U}}", "Vb": "{{\\bf V}}", "xb": "{{\\bf x}}", "ut": "{\\tilde{u}}", "vt": "{\\tilde{v}}", "wt": "{\\tilde{w}}", "Ubt": "{\\widetilde{\\Ub}}", "edge": "{\\rm EDGE}", "mac": "{\\rm MAC}", "trans": "{\\rm TRANS}", "nablab": "{\\mathbf{\\nabla}}", "cdotb": "{\\mathbf{\\cdot}}", "half": "{\\frac{1}{2}}", "myhalf": "{\\frac{1}{2}}", "nph": "{{n + \\myhalf}}", "nmh": "{{n - \\myhalf}}", "Hext": "{{H_{\\rm ext}}}", "Hnuc": "{{H_{\\rm nuc}}}", "kth": "{k_{\\rm th}}", "pred": "{{\\rm pred}}", "Sbar": "{\\overline{S}}", "inp": "{\\mathrm{in}}", "initp": "{\\mathrm{init}}", "outp": "{\\mathrm{out}}", "uadv": "{\\widetilde{\\mathbf{U}}^{\\mathrm{ADV}}}", "uadvone": "{\\widetilde{\\mathbf{U}}^{\\mathrm{ADV},\\star}}", "uadvonedag": "{\\Ubt^{\\mathrm{ADV},\\dagger,\\star}}", "uadvtwo": "{\\widetilde{\\mathbf{U}}^{\\mathrm{ADV}}}", "uadvtwodag": "{\\Ubt^{\\mathrm{ADV},\\dagger}}", "uadvsdcstar": "{\\mathbf{U}^{\\mathrm{ADV},\\star}}", "uadvsdcpred": "{\\mathbf{U}^{\\mathrm{ADV},\\mathrm{pred}}}", "uadvsdc": "{\\mathbf{U}^{\\mathrm{ADV}}}", "dt": "{\\Delta t}", "dr": "{\\Delta r}", "etarho": "{\\eta_{\\rho}}", "etarhoec": "{\\etarho^{\\rm ec}}", "etarhocc": "{\\etarho^{\\rm cc}}", "etarhoflux": "{\\etarho^{\\rm flux}}", "divetarho": "{\\nabla\\cdot(\\etarho\\eb_r)}", "ow": "{\\overline{w}_0}", "dw": "{\\delta w_0}", "thalf": "{\\sfrac{3}{2}}", "rhop": "{{\\rho^{\\prime}}}", "omegadot": "{\\dot{\\omega}}", "er": "{\\mathbf{e}_r}", "ex": "{\\mathbf{e}_x}", "ey": "{\\mathbf{e}_y}", "ez": "{\\mathbf{e}_z}", "Omegab": "{{\\bf \\Omega}}", "rb": "{{\\bf r}}", "isotm": ["{{}^{#2}\\mathrm{#1}}", 2], "edot": "{{{\\dot{e}_\\mathrm{nuc}}}}", "enuc": "{{{{e}_\\mathrm{nuc}}}}", "edotnu": "{{{\\dot{e}_\\nu}}}", "rt": "{\\tilde{r}_0}", "rhob": "{\\ensuremath{\\rho_\\mathrm{base}}}", "Tb": "{\\ensuremath{T_\\mathrm{base}}}", "gcc": "{\\mathrm{g~cm^{-3} }}", "pb": "{p_\\mathrm{base}}", "qburn": "{q_\\mathrm{burn}}", "Uc": "{{\\boldsymbol{\\mathcal{U}}}}", "Fb": "{\\mathbf{F}}", "Sc": "{\\mathbf{S}}", "Shydro": "{{{\\bf S}^{\\mathrm{hydro}}}}", "Rb": "{{\\bf R}}", "Rq": "{{\\bf R}}", "Adv": ["{{\\left [\\boldsymbol{\\mathcal{A}} \\left(#1\\right)\\right]}}", 1], "Advs": ["{{\\boldsymbol{\\mathcal{A}} \\left(#1\\right)}}", 1], "Sdot": "{\\dot{S}}"}}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Runtime parameters" href="rp_intro.html" />
    <link rel="prev" title="StarKiller Basics" href="basics.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >


          
          
          <a href="index.html" class="icon icon-home">
            Microphysics
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
    <div class="branch">
        Branch: <a href="./data_structures.html">main</a> | <a href="./dev/data_structures.html">development</a>
    </div>

        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Microphysics basics</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="preface.html">Preface</a></li>
<li class="toctree-l1"><a class="reference internal" href="basics.html">StarKiller Basics</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Data Structures</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#eos">EOS</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#eos-t"><code class="docutils literal notranslate"><span class="pre">eos_t</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#networks">Networks</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#burn-t"><code class="docutils literal notranslate"><span class="pre">burn_t</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#rate-t-rate-fr-t"><code class="docutils literal notranslate"><span class="pre">rate_t</span></code>, <code class="docutils literal notranslate"><span class="pre">rate_fr_t</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#burn-type-h"><code class="docutils literal notranslate"><span class="pre">burn_type.H</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#integrators">Integrators</a></li>
<li class="toctree-l2"><a class="reference internal" href="#converting-between-types">Converting Between Types</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="rp_intro.html">Runtime parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="eos.html">Equations of State</a></li>
<li class="toctree-l1"><a class="reference internal" href="networks-overview.html">Overview of Reaction Networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="networks.html">Available Reaction Networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="templated_networks.html">Templated Network Righthand Sides</a></li>
<li class="toctree-l1"><a class="reference internal" href="screening.html">Screening of Reaction Rates</a></li>
<li class="toctree-l1"><a class="reference internal" href="integrators.html">Integrating a Network</a></li>
<li class="toctree-l1"><a class="reference internal" href="nse.html">NSE</a></li>
<li class="toctree-l1"><a class="reference internal" href="transport.html">Transport Coefficients</a></li>
<li class="toctree-l1"><a class="reference internal" href="unit_tests.html">Unit Tests</a></li>
<li class="toctree-l1"><a class="reference internal" href="sdc.html">Spectral Deferred Corrections</a></li>
<li class="toctree-l1"><a class="reference internal" href="zreferences.html">References</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Microphysics</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Data Structures</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/data_structures.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="data-structures">
<span id="id1"></span><h1>Data Structures<a class="headerlink" href="#data-structures" title="Link to this heading"></a></h1>
<p>All of the routines in this software package are standardized so that
you interact with them using the same type of data structure, a C++ struct.</p>
<section id="eos">
<h2>EOS<a class="headerlink" href="#eos" title="Link to this heading"></a></h2>
<section id="eos-t">
<h3><code class="docutils literal notranslate"><span class="pre">eos_t</span></code><a class="headerlink" href="#eos-t" title="Link to this heading"></a></h3>
<p>The main data structure for interacting with the EOS is <code class="docutils literal notranslate"><span class="pre">eos_t</span></code>.
This is a collection of data specifying the microphysical state of the
fluid that we are evaluating. This has many components. For a
particular instantiation named <code class="docutils literal notranslate"><span class="pre">eos_state</span></code>, the most important
data is the following:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">eos_state.rho</span></code> : density [<span class="math notranslate nohighlight">\(\mathrm{g~cm^{-3}}\)</span>]</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">eos_state.T</span></code> : temperature [K]</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">eos_state.p</span></code> : pressure [<span class="math notranslate nohighlight">\(\mathrm{erg~cm^{-3}}\)</span>]</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">eos_state.e</span></code> : specific internal energy [<span class="math notranslate nohighlight">\(\mathrm{erg~g^{-1}}\)</span>]</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">eos_state.h</span></code> : specific enthalpy [<span class="math notranslate nohighlight">\(\mathrm{erg~g^{-1}}\)</span>]</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">eos_state.s</span></code> : specific entropy [<span class="math notranslate nohighlight">\(\mathrm{erg~g^{-1}~K^{-1}}\)</span>]</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">eos_state.xn[]</span></code> : mass fractions of species (this is an array, dimensioned to be the number of species, <code class="docutils literal notranslate"><span class="pre">NumSpec</span></code> )</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">eos_state.aux[]</span></code> : any auxiliary variables carried with the fluid (this is an array, dimensioned to be the number of auxiliary quantities, <code class="docutils literal notranslate"><span class="pre">NumAux</span></code> )</p></li>
</ul>
<p>Note that both <code class="docutils literal notranslate"><span class="pre">NumSpec</span></code> and <code class="docutils literal notranslate"><span class="pre">NumAux</span></code> are meant to be properties of the
network, and they will come in through the <code class="docutils literal notranslate"><span class="pre">network_properties.H</span></code> header file.</p>
<p>There is a lot more information that can be saved here, such as the
partial derivatives of the thermodynamic state variables with respect
to each other. To see a complete list, examine the <code class="docutils literal notranslate"><span class="pre">eos_type.H</span></code>
file: <code class="docutils literal notranslate"><span class="pre">Castro/Microphysics/interfaces/eos_type.H</span></code>.</p>
</section>
</section>
<section id="networks">
<h2>Networks<a class="headerlink" href="#networks" title="Link to this heading"></a></h2>
<section id="burn-t">
<h3><code class="docutils literal notranslate"><span class="pre">burn_t</span></code><a class="headerlink" href="#burn-t" title="Link to this heading"></a></h3>
<p>The main data structure for interacting with the reaction networks is
<code class="docutils literal notranslate"><span class="pre">burn_t</span></code>. This holds the composition (mass fractions), thermodynamic
state, and a lot of internal information used by the reaction network
(e.g. the righthand side of the ODEs, the Jacobian, etc.). Typically
the user will only need to fill/use the following information:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">burn_state.rho</span></code>: density [<span class="math notranslate nohighlight">\(\mathrm{g~cm^{-3}}\)</span>]</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">burn_state.T</span></code>: temperature [K]</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">burn_state.e</span></code>: the specific internal energy [<span class="math notranslate nohighlight">\(\mathrm{erg~g^{-1}}\)</span>]</p>
<blockquote>
<div><p>Note: this has two different contexts, depending on when it is
accessed.</p>
<p>When you call the integrator and are in the process of integrating
the reaction system, e will be an integration variable and
will account for the nuclear energy release.  It will also be used to
derive the temperature via the EOS.</p>
<p>Upon exit of the integration, the initial internal energy (offset)
is subtracted off, and e now represents the specific nuclear
energy release from the reactions.</p>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">burn_state.xn[]</span></code>: the mass fractions</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">burn_state.aux[]</span></code>: any auxiliary quantities (like <span class="math notranslate nohighlight">\(Y_e\)</span>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">burn_state.i</span></code>, <code class="docutils literal notranslate"><span class="pre">.j</span></code>, <code class="docutils literal notranslate"><span class="pre">.k</span></code>: hydrodynamic zone i, j, k for bug reporting, diagnostics</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">burn_state.time</span></code>: the time since the start of the integration [s]</p>
<blockquote>
<div><p>Note this is not the same as the simulation time. Each integrator
will also store the simulation time at the start of integration
in their local storage—this can be used as an offset to convert
between integration and simulation time.</p>
</div></blockquote>
</li>
</ul>
</section>
<section id="rate-t-rate-fr-t">
<h3><code class="docutils literal notranslate"><span class="pre">rate_t</span></code>, <code class="docutils literal notranslate"><span class="pre">rate_fr_t</span></code><a class="headerlink" href="#rate-t-rate-fr-t" title="Link to this heading"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">rate_t</span></code> and <code class="docutils literal notranslate"><span class="pre">rate_fr_t</span></code> structures are used internally in a network to pass the
raw reaction rate information (usually just the temperature-dependent
terms) between various subroutines. It does not come out of the
network-specific righthand side or Jacobian routines.</p>
<p>You can see their definitions in <code class="docutils literal notranslate"><span class="pre">networks/rate_type.H</span></code>.</p>
</section>
<section id="burn-type-h">
<h3><code class="docutils literal notranslate"><span class="pre">burn_type.H</span></code><a class="headerlink" href="#burn-type-h" title="Link to this heading"></a></h3>
<p>In addition to defining the <code class="docutils literal notranslate"><span class="pre">burn_t</span></code> type, the header <code class="docutils literal notranslate"><span class="pre">burn_type.H</span></code>
also defines integer indices into the solution vector that can be used
to access the different components of the state:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">neqs</span></code> : the total number of variables we are integrating.</p>
<blockquote>
<div><p>It is assumed that the first <code class="docutils literal notranslate"><span class="pre">nspec</span></code> are the species.</p>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">net_ienuc</span></code> : the index of the specific internal energy in the solution vector</p></li>
</ul>
</section>
</section>
<section id="integrators">
<h2>Integrators<a class="headerlink" href="#integrators" title="Link to this heading"></a></h2>
<p>Each integrator also has their own internal data structure that holds
the information needed for the integration.  Meta-data that is not
part of the integration vector of ODEs, but is attached to a
particular state (<span class="math notranslate nohighlight">\(X_k\)</span>, <span class="math notranslate nohighlight">\(T\)</span>, <span class="math notranslate nohighlight">\(e\)</span>), is stored in the
<code class="docutils literal notranslate"><span class="pre">burn_t</span></code> and can be passed into the righthand side routine.</p>
</section>
<section id="converting-between-types">
<h2>Converting Between Types<a class="headerlink" href="#converting-between-types" title="Link to this heading"></a></h2>
<p>There is significant overlap between <code class="docutils literal notranslate"><span class="pre">eos_t</span></code> and <code class="docutils literal notranslate"><span class="pre">burn_t</span></code>.
The <code class="docutils literal notranslate"><span class="pre">burn_type.H</span></code> header two routines,
<code class="docutils literal notranslate"><span class="pre">burn_to_eos</span></code> and <code class="docutils literal notranslate"><span class="pre">eos_to_burn</span></code> that convert a <code class="docutils literal notranslate"><span class="pre">burn_t</span></code>
state to an <code class="docutils literal notranslate"><span class="pre">eos_t</span></code> state, and back. Only the thermodynamic
variables that are common in the two types are copied. This is
useful, for example, if you have a burn_t state and what to get
thermodynamic information by calling the EOS.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="basics.html" class="btn btn-neutral float-left" title="StarKiller Basics" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="rp_intro.html" class="btn btn-neutral float-right" title="Runtime parameters" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2012, Microphysics Development Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>  


</body>
</html>