<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Overview of Reaction Networks &mdash; Microphysics  documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/theme_overrides.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=5929fcd5"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "macros": {"rhozero": "{\\rho_0}", "pizero": "{\\pi_0}", "pizeroone": "{\\pi_0^{(1)}}", "pizerotwo": "{\\pi_0^{(2)}}", "gammabar": "{\\overline{\\Gamma}_1}", "ptl": "{{\\partial}}", "eb": "{{\\bf e}}", "fb": "{{\\bf f}}", "ib": "{{\\bf i}}", "Ub": "{{\\bf U}}", "Vb": "{{\\bf V}}", "xb": "{{\\bf x}}", "ut": "{\\tilde{u}}", "vt": "{\\tilde{v}}", "wt": "{\\tilde{w}}", "Ubt": "{\\widetilde{\\Ub}}", "edge": "{\\rm EDGE}", "mac": "{\\rm MAC}", "trans": "{\\rm TRANS}", "nablab": "{\\mathbf{\\nabla}}", "cdotb": "{\\mathbf{\\cdot}}", "half": "{\\frac{1}{2}}", "myhalf": "{\\frac{1}{2}}", "nph": "{{n + \\myhalf}}", "nmh": "{{n - \\myhalf}}", "Hext": "{{H_{\\rm ext}}}", "Hnuc": "{{H_{\\rm nuc}}}", "kth": "{k_{\\rm th}}", "pred": "{{\\rm pred}}", "Sbar": "{\\overline{S}}", "inp": "{\\mathrm{in}}", "initp": "{\\mathrm{init}}", "outp": "{\\mathrm{out}}", "uadv": "{\\widetilde{\\mathbf{U}}^{\\mathrm{ADV}}}", "uadvone": "{\\widetilde{\\mathbf{U}}^{\\mathrm{ADV},\\star}}", "uadvonedag": "{\\Ubt^{\\mathrm{ADV},\\dagger,\\star}}", "uadvtwo": "{\\widetilde{\\mathbf{U}}^{\\mathrm{ADV}}}", "uadvtwodag": "{\\Ubt^{\\mathrm{ADV},\\dagger}}", "uadvsdcstar": "{\\mathbf{U}^{\\mathrm{ADV},\\star}}", "uadvsdcpred": "{\\mathbf{U}^{\\mathrm{ADV},\\mathrm{pred}}}", "uadvsdc": "{\\mathbf{U}^{\\mathrm{ADV}}}", "dt": "{\\Delta t}", "dr": "{\\Delta r}", "etarho": "{\\eta_{\\rho}}", "etarhoec": "{\\etarho^{\\rm ec}}", "etarhocc": "{\\etarho^{\\rm cc}}", "etarhoflux": "{\\etarho^{\\rm flux}}", "divetarho": "{\\nabla\\cdot(\\etarho\\eb_r)}", "ow": "{\\overline{w}_0}", "dw": "{\\delta w_0}", "thalf": "{\\sfrac{3}{2}}", "rhop": "{{\\rho^{\\prime}}}", "omegadot": "{\\dot{\\omega}}", "er": "{\\mathbf{e}_r}", "ex": "{\\mathbf{e}_x}", "ey": "{\\mathbf{e}_y}", "ez": "{\\mathbf{e}_z}", "Omegab": "{{\\bf \\Omega}}", "rb": "{{\\bf r}}", "isotm": ["{{}^{#2}\\mathrm{#1}}", 2], "edot": "{{{\\dot{e}_\\mathrm{nuc}}}}", "enuc": "{{{{e}_\\mathrm{nuc}}}}", "edotnu": "{{{\\dot{e}_\\nu}}}", "rt": "{\\tilde{r}_0}", "rhob": "{\\ensuremath{\\rho_\\mathrm{base}}}", "Tb": "{\\ensuremath{T_\\mathrm{base}}}", "gcc": "{\\mathrm{g~cm^{-3} }}", "pb": "{p_\\mathrm{base}}", "qburn": "{q_\\mathrm{burn}}", "Uc": "{{\\boldsymbol{\\mathcal{U}}}}", "Fb": "{\\mathbf{F}}", "Sc": "{\\mathbf{S}}", "Shydro": "{{{\\bf S}^{\\mathrm{hydro}}}}", "Rb": "{{\\bf R}}", "Rq": "{{\\bf R}}", "Adv": ["{{\\left [\\boldsymbol{\\mathcal{A}} \\left(#1\\right)\\right]}}", 1], "Advs": ["{{\\boldsymbol{\\mathcal{A}} \\left(#1\\right)}}", 1], "Sdot": "{\\dot{S}}"}}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Available Reaction Networks" href="networks.html" />
    <link rel="prev" title="Equations of State" href="eos.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >


          
          
          <a href="index.html" class="icon icon-home">
            Microphysics
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
    <div class="branch">
        Branch: <a href="./networks-overview.html">main</a> | <a href="./dev/networks-overview.html">development</a>
    </div>

        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Microphysics basics</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="preface.html">Preface</a></li>
<li class="toctree-l1"><a class="reference internal" href="basics.html">StarKiller Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="data_structures.html">Data Structures</a></li>
<li class="toctree-l1"><a class="reference internal" href="rp_intro.html">Runtime parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="eos.html">Equations of State</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Overview of Reaction Networks</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#types-of-networks">Types of Networks</a></li>
<li class="toctree-l2"><a class="reference internal" href="#network-requirements-and-structure">Network Requirements and Structure</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="networks.html">Available Reaction Networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="templated_networks.html">Templated Network Righthand Sides</a></li>
<li class="toctree-l1"><a class="reference internal" href="screening.html">Screening of Reaction Rates</a></li>
<li class="toctree-l1"><a class="reference internal" href="integrators.html">Integrating a Network</a></li>
<li class="toctree-l1"><a class="reference internal" href="nse.html">NSE</a></li>
<li class="toctree-l1"><a class="reference internal" href="transport.html">Transport Coefficients</a></li>
<li class="toctree-l1"><a class="reference internal" href="unit_tests.html">Unit Tests</a></li>
<li class="toctree-l1"><a class="reference internal" href="sdc.html">Spectral Deferred Corrections</a></li>
<li class="toctree-l1"><a class="reference internal" href="zreferences.html">References</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Microphysics</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Overview of Reaction Networks</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/networks-overview.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="overview-of-reaction-networks">
<h1>Overview of Reaction Networks<a class="headerlink" href="#overview-of-reaction-networks" title="Link to this heading"></a></h1>
<section id="types-of-networks">
<h2>Types of Networks<a class="headerlink" href="#types-of-networks" title="Link to this heading"></a></h2>
<p>There are several different types of reaction networks in Microphysics.  Largely these can
be split into:</p>
<ul>
<li><p><em>hardcoded networks</em>: the structure of the network rates linking the
nuclei was written by hand. Many of these networks are <em>approximate
networks</em> where the links between two nuclei includes steps
involving nuclei that are not directly represented in the network.
Since the rates are hardcoded, it can be difficult to update the
individual rates.</p>
<p>A common example is to combine <span class="math notranslate nohighlight">\((\alpha,\gamma)\)</span> and
<span class="math notranslate nohighlight">\((\alpha,p)(p,\gamma)\)</span> channels without explicitly including
the protons or nuclei produced by the <span class="math notranslate nohighlight">\((\alpha,p)\)</span> reaction in
the network.  This reduces the size of the network at the expense of
making the individual rates more complex.</p>
<p>Many of these networks came from the collection of networks that
<a class="reference external" href="https://cococubed.com/code_pages/burn.shtml">Frank Timmes provides</a>, and subsequently
converted into C++ and adapted to our framework.</p>
</li>
<li><p><em>automatically-generated networks</em>: these networks are automatically
generated simply by providing a list of nuclei and having
<a class="reference external" href="https://github.com/pynucastro/pynucastro">pynucastro</a> find all of
the linking rates.  These can easily be regenerated to reflect new rates.</p></li>
</ul>
</section>
<section id="network-requirements-and-structure">
<h2>Network Requirements and Structure<a class="headerlink" href="#network-requirements-and-structure" title="Link to this heading"></a></h2>
<p>A network both defines the composition advected by the hydro code as
well as describes the burning processes between those isotopes.
Evolving the species in a network requires an integrator. The design
of Microphysics decouples the integrator from the network, allowing
for the ability to swap integrators as desired. We discuss the
integrators in a later section.</p>
<p>A network is defined by a <code class="docutils literal notranslate"><span class="pre">.net</span></code> file which provides a list of species
and some data about each species (its name and some isotopic data).</p>
<p>An example is <code class="docutils literal notranslate"><span class="pre">Microphysics/networks/iso7/iso7.net</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># This is a null network corresponding to the iso7 burner.</span>

<span class="c1"># name              short name      aion     zion</span>
 <span class="n">helium</span><span class="o">-</span><span class="mi">4</span>                  <span class="n">He4</span>       <span class="mf">4.0</span>      <span class="mf">2.0</span>
 <span class="n">carbon</span><span class="o">-</span><span class="mi">12</span>                 <span class="n">C12</span>      <span class="mf">12.0</span>      <span class="mf">6.0</span>
 <span class="n">oxygen</span><span class="o">-</span><span class="mi">16</span>                 <span class="n">O16</span>      <span class="mf">16.0</span>      <span class="mf">8.0</span>
 <span class="n">neon</span><span class="o">-</span><span class="mi">20</span>                  <span class="n">Ne20</span>      <span class="mf">20.0</span>     <span class="mf">10.0</span>
 <span class="n">magnesium</span><span class="o">-</span><span class="mi">24</span>             <span class="n">Mg24</span>      <span class="mf">24.0</span>     <span class="mf">12.0</span>
 <span class="n">silicon</span><span class="o">-</span><span class="mi">28</span>               <span class="n">Si28</span>      <span class="mf">28.0</span>     <span class="mf">14.0</span>
 <span class="n">nickel</span><span class="o">-</span><span class="mi">56</span>                <span class="n">Ni56</span>      <span class="mf">56.0</span>     <span class="mf">28.0</span>
 <span class="n">__extra_beryllium</span><span class="o">-</span><span class="mi">8</span>       <span class="n">Be8</span>       <span class="mf">8.0</span>      <span class="mf">4.0</span>
 <span class="n">__extra_calcium</span><span class="o">-</span><span class="mi">40</span>       <span class="n">Ca40</span>      <span class="mf">40.0</span>     <span class="mf">20.0</span>
 <span class="n">__extra_titanium</span><span class="o">-</span><span class="mi">44</span>      <span class="n">Ti44</span>      <span class="mf">44.0</span>     <span class="mf">22.0</span>
</pre></div>
</div>
<p>Lines beginning with <code class="docutils literal notranslate"><span class="pre">#</span></code> are comments.  In this example, there are 7
nuclei that are evolved in the network.  We also have 3 additional
nuclei prefixed with <code class="docutils literal notranslate"><span class="pre">__extra_</span></code> – these nuclei will not be know to
the ODE system but we will be able to access their properties (like
<span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(Z\)</span>) while constructing the righthand side of the
network.</p>
<p>At build
time, a file <code class="docutils literal notranslate"><span class="pre">network_properties.H</span></code> is automatically generated which contains
a number of variables, including:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">NumSpec</span></code> : the number of species evolved in the network</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">NumSpecExtra</span></code> : the number of evolved and “extra” species, as
prefixed with <code class="docutils literal notranslate"><span class="pre">__extra_</span></code> in the <code class="docutils literal notranslate"><span class="pre">.net</span></code> file.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">NumAux</span></code> : the number of auxiliary quantities needed by the network (these are not evolved).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">aion[NumSpec]</span></code> : the atomic weight (in atomic mass units) of the species.  This includes the extra species.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">zion[NumSpec]</span></code> : the atomic number of the species.  This includes the extra species.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">spec_names[NumSpec]</span></code> : a descriptive name of the species (e.g. “hydrogen-1”).  This includes the extra species.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">short_spec_names[NumSpec]</span></code> : a shortened version of the species name (e.g. “H1”).  This includes the extra species.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">aux_names[NumAux]</span></code>: the names of the auxiliary quantities</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">short_aux_names[NumAux]</span></code> : a shortened version of the auxiliary name</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A convention adopted in Microphysics is that each network is
responsible for determining the energy release from a change in
composition. Most networks will provide an array of the species
binding energies and a routine to compute the energy yield from the
reaction rates.</p>
</div>
<p>There are two primary files within each network directory.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">actual_network.H</span></code> (as well as <code class="docutils literal notranslate"><span class="pre">actual_network_data.H</span></code> and <code class="docutils literal notranslate"><span class="pre">actual_network_data.cpp</span></code>):</p>
<blockquote>
<div><p>This header defines data for the network such as enumerators for the reaction rates
and the binding energies. The header must define the following function, which can be
used to initialize any of the network’s internal data at runtime.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">actual_network_init()</span></code></p></li>
</ul>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">actual_rhs.H</span></code> (as well as <code class="docutils literal notranslate"><span class="pre">actual_rhs_data.H</span></code> and <code class="docutils literal notranslate"><span class="pre">actual_rhs_data.cpp</span></code>):</p>
<blockquote>
<div><p>This header defines the functions which are used in the integrator for a burn:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">actual_rhs_init()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">actual_rhs(state,</span> <span class="pre">rhs)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">actual_jac(state,</span> <span class="pre">jac)</span></code></p></li>
</ul>
<p>This supplies an interface for computing the right-hand-side of the
network, the time-derivative of each species (and the temperature
and nuclear energy release), as well as the analytic Jacobian.
Both <code class="docutils literal notranslate"><span class="pre">actual_rhs</span></code> and <code class="docutils literal notranslate"><span class="pre">actual_jac</span></code> take as arguments a burn_t
state and (respectively) the time-derivatives and Jacobian
elements to fill in.</p>
<p>Note: some networks do not provide an analytic Jacobian and instead
rely on the numerical difference-approximation to the Jacobian. In
this case, the interface <code class="docutils literal notranslate"><span class="pre">actual_jac</span></code> is still needed to compile.</p>
</div></blockquote>
</li>
</ul>
<p>Notice that these modules have initialization routines:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">actual_network_init()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">actual_rhs_init()</span></code></p></li>
</ul>
<p>These must be called upon initialization. These should be not called
within OpenMP parallel regions, because in general they will modify
global data.</p>
<p>Note, depending on the network, some of these may do nothing, but
these interfaces are all required for maximum flexibility.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="eos.html" class="btn btn-neutral float-left" title="Equations of State" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="networks.html" class="btn btn-neutral float-right" title="Available Reaction Networks" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2012, Microphysics Development Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>  


</body>
</html>